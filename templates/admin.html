{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Administration{% endblock %}</h1>
{% endblock %}

{% block content %}

<h1>Administration des Utilisateurs</h1>
    
<!-- Affichage des messages flash -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert {{ category }}">{{ message }}</div>
        {% endfor %}
    {% endif %}
{% endwith %}

<h2>Créer un nouvel utilisateur</h2>
<div class="login-container">
    <form method="POST">
		<div class="form-group">
			<label for="username">Nom d'utilisateur :</label>
			<input type="text" id="username" name="username" required>
		</div>
        
		<div class="form-group">
			<label for="email">Email :</label>
			<input type="email" id="email" name="email" required>
		</div>
        
		<div class="form-group">
			<label for="password">Mot de passe :</label>
			<input type="password" id="password" name="password" required><br><br>
        </div>
		
		<div class="form-group">
			<label for="role">Rôle :</label>
			<select id="role" name="role">
				<option value="user">Utilisateur</option>
				<option value="admin">Administrateur</option>
			</select>
		</div>
        
        <button type="submit">Créer</button>
    </form>
</div>

<h2 class="mt-5">Liste des utilisateurs</h2>
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Nom d'utilisateur</th>
            <th>Email</th>
            <th>Rôle</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.role }}</td>
            <td>
                <form action="{{ url_for('edit_user', user_id=user['id']) }}" method="get" style="display:inline-block;">
                    <button type="submit" class="btn btn-edit">Modifier</button>
                </form>
                <form action="{{ url_for('delete_user', user_id=user['id']) }}" method="post" style="display:inline-block;" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cet utilisateur ?');">
                    <button type="submit" class="btn btn-delete">Supprimer</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>





{% endblock %}
